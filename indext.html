<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khushi Pay - Smart Wallet with Scanner</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        :root { --primary: #2ecc71; --secondary: #27ae60; --dark: #2c3e50; --light: #ecf0f1; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--light); margin: 0; display: flex; justify-content: center; }
        .app-container { width: 100%; max-width: 400px; background: white; min-height: 100vh; position: relative; }
        .header { background: var(--primary); color: white; padding: 20px; text-align: center; border-radius: 0 0 25px 25px; }
        .wallet-card { background: var(--dark); color: white; margin: -30px 20px 20px; padding: 20px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .balance-amount { font-size: 32px; font-weight: bold; }
        .actions { display: flex; justify-content: space-around; padding: 10px; }
        .btn { cursor: pointer; display: flex; flex-direction: column; align-items: center; font-size: 12px; }
        .btn-icon { background: var(--primary); color: white; width: 50px; height: 50px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-bottom: 5px; }
        #reader { width: 100%; display: none; margin-top: 20px; }
        .section { padding: 20px; }
        .pay-btn { background: var(--primary); color: white; border: none; width: 100%; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        input { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <h2>‡§ñ‡•Å‡§∂‡•Ä ‡§™‡•á (Khushi Pay)</h2>
    </div>

    <div class="wallet-card">
        <div style="font-size:14px; opacity:0.8;">‡§µ‡•â‡§≤‡•á‡§ü ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏</div>
        <div class="balance-amount">‚Çπ <span id="balance">0.00</span></div>
    </div>

    <div class="actions">
        <div class="btn" onclick="addMoney()"><div class="btn-icon">‚ûï</div><span>‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú</span></div>
        <div class="btn" onclick="startScanner()"><div class="btn-icon">üì∏</div><span>‡§∏‡•ç‡§ï‡•à‡§®</span></div>
        <div class="btn" onclick="showPay()"><div class="btn-icon">üì§</div><span>‡§≠‡•á‡§ú‡•á‡§Ç</span></div>
    </div>

    <div id="reader"></div>

    <div class="section" id="pay-area" style="display:none;">
        <h3>‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡§∞‡•á‡§Ç</h3>
        <input type="text" id="target" placeholder="‡§®‡§Ç‡§¨‡§∞ ‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•à‡§® ‡§Ü‡§à‡§°‡•Ä">
        <input type="number" id="payAmount" placeholder="‡§Ö‡§Æ‡§æ‡§â‡§Ç‡§ü (‚Çπ)">
        <button class="pay-btn" onclick="processPayment()">‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>

    <div class="section">
        <h3>‡§≤‡•á‡§®-‡§¶‡•á‡§® ‡§á‡§§‡§ø‡§π‡§æ‡§∏</h3>
        <div id="history" style="font-size:14px; color:#555;">‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</div>
    </div>
</div>

<script>
    let balance = parseFloat(localStorage.getItem('walletBalance')) || 0;
    document.getElementById('balance').innerText = balance.toFixed(2);

    function addMoney() {
        let amt = prompt("‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú ‡§Ö‡§Æ‡§æ‡§â‡§Ç‡§ü ‡§°‡§æ‡§≤‡•á‡§Ç (‚Çπ):");
        if(amt && !isNaN(amt)) {
            balance += parseFloat(amt);
            updateUI("‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú (‡§Æ‡§Æ‡•ç‡§Æ‡•Ä/‡§™‡§æ‡§™‡§æ)", amt, "plus");
        }
    }

    function startScanner() {
        document.getElementById('reader').style.display = 'block';
        const html5QrCode = new Html5Qrcode("reader");
        html5QrCode.start(
            { facingMode: "environment" }, 
            { fps: 10, qrbox: { width: 250, height: 250 } },
            (decodedText) => {
                html5QrCode.stop();
                document.getElementById('reader').style.display = 'none';
                document.getElementById('target').value = "Scanned ID";
                showPay();
            }
        ).catch(err => alert("‡§ï‡•à‡§Æ‡§∞‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ!"));
    }

    function showPay() {
        document.getElementById('pay-area').style.display = 'block';
    }

    function processPayment() {
        let amt = parseFloat(document.getElementById('payAmount').value);
        if(amt > 0 && amt <= balance) {
            balance -= amt;
            updateUI("‡§™‡•á‡§Æ‡•á‡§Ç‡§ü (‡§∏‡•ç‡§ï‡•à‡§®/‡§®‡§Ç‡§¨‡§∞)", amt, "minus");
            document.getElementById('pay-area').style.display = 'none';
            alert("‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§∏‡§´‡§≤!");
        } else {
            alert("‡§¨‡•à‡§≤‡•á‡§Ç‡§∏ ‡§ï‡§Æ ‡§π‡•à!");
        }
    }

    function updateUI(note, amt, type) {
        localStorage.setItem('walletBalance', balance);
        document.getElementById('balance').innerText = balance.toFixed(2);
        let history = document.getElementById('history');
        if(history.innerText.includes("‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç")) history.innerHTML = "";
        history.innerHTML = `<div>${note}: <span style="color:${type==='plus'?'green':'red'}">${type==='plus'?'+':'-'}‚Çπ${amt}</span></div>` + history.innerHTML;
    }
</script>

</body>
</html>